<head>
    <meta charset="utf-8">
    <title>P59: Graph Algorithms for CRISPR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="bootstrap.css">
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-23019901-1"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>	
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-23019901-1');
    </script>
    <style>
      @font-face { font-family: SourceCodePro; src: url('SourceCodePro-Regular.otf'); } 
      p1 {
         font-family: SourceCodePro
      }
    </style>
  <script id="_carbonads_projs" type="text/javascript" src="https://srv.carbonads.net/ads/CKYIE23N.json?segment=placement:bootswatchcom&amp;callback=_carbonads_go"></script>
</head>
<body>
  <!--Chapter 1 and Intro-->  
    <nav  class="navbar navbar-expand-lg navbar-dark fixed-top bg-primary">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">P59</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav me-auto">
              <li class="nav-item">
                <a class="nav-link " href="#ch1">Introduction >
                  <span class="visually-hidden">(current)</span>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#ch2">Challenges of Modern Tools ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#ch3">Motivation ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#ch4">Central Idea ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#ch5">The Algorithm ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#ch6">Results ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Outlook and take-home message </a>
              </li>
              
              
            </ul>
            
          </div>
        </div>
      </nav>
      <div class="container" id="ch1">
      <br>
      <h2 style="color:white"><center>Graph Based Strategies to Finding CRISPR Arrays in Metagenomic Data</center></h2>
        <h2><center>Graph Based Strategies to Finding CRISPR Arrays in Metagenomic Data</center></h2>
        <h3 style="color: darkslategrey;"><center>Fikrat Talibli & Björn Voss</center></h3>
        <hr>
        <h3>Introduction</h3>
        <hr>
        <p><b>Clustered Regularly Interspaced Short Palindromic Repeats</b> or <b><a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/17379808/" >CRISPR</a></b> are a genetic immune system of bacteria . CRISPR systems consist of two major parts: 
            <ul>
                <li>CRISPR arrays</li>
                <li><b>CRISPR associated proteins - CAS genes.</b></li>
            </ul>
        </p>
        <div class="row">
          <div id="myImg" class="col-md-6 col-sm-12"><br><img src="1.png" style="max-width: 100%; height:auto; width:auto" id="responsive-image"> </div>
          
          <div class="col-md-6 col-sm-12">
            <br>  
            <div class="card border-info">
              <div style="font-size: large; color: blue;" class="card-header">The GOAL</div>
              <div class="card-body">
                
                <p style="font-size: large; color: blue;">Our work concentrates on
                  <i>finding CRISPR arrays. </i></p>
              </div>
            </div>
        </div>
        
        
        <div id="myModal" class="modal">

          <!-- The Close Button -->
          <span class="close">&times;</span>
          <br>
          <br>
          <img class="modal-content" src="1.png" d="img01">
        
          <!-- Modal Caption (Image Text) -->
          <div id="">CRISPR arrays structure</div>
          
        </div>
        <div class="container">
        <p color="white"></p>
        <p>Additional info from <a target=”_blank” href="https://crisprcas.i2bc.paris-saclay.fr/Home/About">CRISPR-Cas++</a>:</p>
          <ul>
            <li><b>Repeats and Spacers</b>: A CRISPR is a succession of 23-47bp sequences called repeats separated by unique sequences of a similar length (spacers). </li>
            <li><b>A leader sequence</b>: the CRISPR locus is AT-rich leader sequence of 100-350 bp, acting as a promoter for the pre-crRNA synthesis.</li>
            <li>Together with a set of genes called cas for “CRISPR-associated”, they constitute an immune system.</li>
          </ul>
        </div>
        </div>
</div>
<div class="container" id="ch2">
  <hr>
  <h3>Challenges of modern tools</h3>
  <hr>
  
  <div class="row">
    <div class="col-md-6 col-sm-12">
      <p>There are many tools that are using bacterial genomes for finding CRISPR Arrays.</p>
    <p>However, viruses are underrepresented in reference databases and have high mutation rates. Additionally:
    </p><ul>
        <li>Most organisms cannot  be cultivated in labs </li>
        <li>A lot of data is lost in assembly </li>
      </ul>
      
    </div>
  <div id="myImg" class="col-md-6 col-sm-12"><br><img src="2.png" style="display: block; margin-left: auto;
    margin-right: auto; max-height:85%; max-width: 100%; height:auto; width:auto" id="responsive-image"> </div>
  
  <p><b><a target="_blank" href="https://www.genome.gov/genetics-glossary/Metagenomics#:~:text=Metagenomics%20is%20the%20study%20of,or%20in%20a%20water%20sample.">Raw metagenomic data</a></b> offer the potential to increase the diversity of known CRISPR-Cas systems.
    <b>Metagenomic data</b> represent a snapshot of habitat at a defined timepoint.
    </p>
</div>
<p style="color:blue"> <i>Goal adjustment: find CRISPR arrays in <b>metagenomic data.</b></i></p>


</div>
<div class="container" id="ch3">
  <h3 style="color:white">Chap3</h3>
  <hr>
  
  <h3>Motivation</h3>
  <hr>
  <div class="row">
    <div id="img04" class="col-md-5 col-sm-12"><br><img src="3.png" style="display: block; margin-left: auto;
      margin-right: auto; max-height:85%; max-width: 100%; height:auto; width:auto" id="responsive-image"> </div>
    <div class="col-md-7 col-sm-12">
    <p>Schema above(on the left) demonstrates two different approaches:
    <ul>
      <li>We took a raw metagenomic dataset with 425 mil. Illumina reads;</li>
      <li>We applied 2 different approaches</li>
      <ul>
        <li><b><i>Assembly-first</i></b> approach:</li>
        <ol>
          <li>Assemble metagenome using e.g. <b><a href="https://pubmed.ncbi.nlm.nih.gov/25609793/" target="_blank">MegaHIT</a></b></li>
          <li>Use one of the tools for CRISPR analysis: <b><a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/17577412/">CRT</a></b>, <b><a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-016-2627-0" target="_blank">CRISPRDetect</a></b></li>
        </ol>
      </ul>
      <ul>
        <li><b><i>Analysis</i></b> approach:</li>
        <ol>
          <li>Read in raw metagenomic dataset</li>
          <li>Use a tool for CRISPR analysis: <b><a href="https://pubmed.ncbi.nlm.nih.gov/23511966/" target="_blank">CRASS</a></b></li>
        </ol>
      </ul>
      <li>Venn diagram with predicted CRISPR systems using three tools: CRT,CRISPRDetect and CRASS .</li>
      <ul>
        <li>CRISPRDetect predicted <b>188</b> CRISPR systems;</li>
        <li>CRT predicted <b>72</b> CRISPR systems;</li>
        <li>CRASS detected <b>290</b> CRISPR systems.</li>  
      </ul>
      <li><b>The overlap</b> between these three tools is very small - only 5 CRISPR systems.</li>
    </ul>
    
  </p>
  <p>
    <b>We propose the new method based on <a target="_blank" href="https://towardsdatascience.com/genome-assembly-using-de-bruijn-graphs-69570efcc270">de Bruijn graph.</a></b>
  </p>
    </div>
  </div>
  
 
</div>
<div class="container" id="ch4">
  <h3 style="color:white">Chap4</h3>
  <hr>
  
  <h3>Central idea</h3>
  <hr>
  <div class="row">
    <div id="img04" class="col-md-6 col-sm-12"><br><img src="4.png" style="align-items: center; max-height:80%; max-width: 100%; height:auto; width:auto" id="responsive-image"> </div>
    <div id="img04" class="col-md-6 col-sm-12"><br><img src="5.png" style="align-items: center; max-height:80%; max-width: 100%; height:auto; width:auto" id="responsive-image"> </div>
    
  </div>
  </p>
  <p>
    Definitions: 
  </p>
  <ul>
    <li>
      <b>k-mers</b> are slices of reads of length k at every index of a read sequence. 
    </li>
    <li>
      <b>De Bruijn Graph</b> is a directed graph, where Edges are <i>k-mers</i> and nodes are <i>k-1</i>-mers. 
      E.g.: edges: <i>{ACTG,CTGT}</i> Nodes: <i>{ACT,CTG}</i>
    </li>
  </ul>
    <p>Let us see how the CRISPR arrays look like on de Bruijn graph. Suppose we have following CRISPR array sequence: <i>AACTTAAACCGGAAC</i></p> 
    <div id="myImg1" class="row">
      <div class="col-md-6 col-sm-12">
        <img  src="6.png" style="display: block;
        margin-left: auto;
        margin-right: auto; max-height:100%; max-width: 100%; height:auto; width:auto" id="responsive-image">
        <h5 style="color:white">TEAM OTTO</h5>
        <h5 style="color:black"><ul>
          <li>
            Repeat: AAC 
          </li>
          <li>
            Spacers: TTA, CGG
          </li>
        </ul>
      </h5>
      </div>
      <div class="col-md-6 col-sm-12">
        <img  src="6_1.png" style=" display: block;
        margin-left: auto;
        margin-right: auto; max-height:85%; max-width: 85%; height:auto; width:auto" id="responsive-image">
      </div>
    </div>
    <div id="myModal1" class="modal">

      <!-- The Close Button -->
      <span class="close">&times;</span>
      <br>
      <br>
     
      <img class="modal-content" src="6_1.png" d="img02">
    
      <!-- Modal Caption (Image Text) -->
      
    </div>
    <div class="row">
      <div class="col-md-6 col-sm-12">
        <img  src="7.png" style="display: block;
        margin-left: auto;
        margin-right: auto;max-height:85%; max-width: 85%; height:auto; width:auto" id="responsive-image">
      </div>
      <div class="col-md-6 col-sm-12">
        <img  src="8.png" style="display: block;
        margin-left: auto;
        margin-right: auto; max-height:100%; max-width: 100%; height:auto; width:auto" id="responsive-image">
      </div>
    </div>
    <div class="card border-secondary">
      <div class="card-header"><h5>CYCLES AND CRISPR ARRAYS</h5></div>
      <div class="card-body">
        <p class="card-title">From above we see that CRISPR arrays are forming <b>multicycles</b> with following parameters:</p>
        <p class="card-text"><ul>
          <li><b><i>k</i></b> is less than minimum length of repeat</li>
          <li>minimum length of repeat is <b>23</b> bp => <b>k=22</b></li>
          <li>length of each cycle:</li>
          <ul>
            <li>Sum of spacer and repeat lengths</li>
            <li>they vary from 46-94 nodes.</li>
          </ul>
        </ul></p>
      </div>
    </div>
    <br>
    <div class="card border-secondary">
      <div class="card-header"><h5>Computationally Formulated Goal</h5></div>
      <div class="card-body">
        <p class="card-title">Find cycles limited to <b>46-94</b> nodes in de Bruijn graph constructed from metagenomic datasets, with <b>k-mer size <i>22</i>.</b></p>
        
      </div>
    </div>
    <br>
    
  </div>
  <div class="container" id="ch5">
    <h3 style="color:white">TEAM Wo Ist?</h3>
    <hr>
    
    <h3>The algorithm</h3>
    <hr>
    <div class="row">
      <div id="img05" class="col-md-5 col-sm-12"><img src="9.png" style="display: block; margin-left: auto;
        margin-right: auto; max-height:85%; max-width: 100%; height:auto; width:auto" id="responsive-image"></div>
     <div class="col-md-7 col-sm-12">
      <div class="card border-secondary">
        <div class="card-header"><h5>STRUCTURE OF THE ALGORITHM</h5></div>
        <div class="card-body">
          <p class="card-title">The rough structure of the algorithm is as follows:</p>
          <p class="card-text"><ul>
            <li>Generate a de Bruijn graph.</li>
            <li><b><i>Pre-processing:</i></b> this algorithm masks linear paths in de Bruijn graph to optimize the next two steps.</li>
            <li>Use <a href="https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm" target="_blank"><b>Tarjan's algorithm</b></a> to isolate all strongly connected components, i.e. the area where any chosen node reaches itself through any taken route.</li>
            <li>Use <b>restricted <a target="_blank" href="">Johnson's algorithm</a></b> to find cycles 46-94 nodes. Johnson's algorithm finds every circle/cycle in any given graph. The time complexity can be reduced given that the number of nodes in each circle is restricted to certain quantity.</li>
            <li>Future outlook: post-processing algorithmto remove false positives.</li>
          </ul></p>
        </div>
      </div>
      
     </div>
    </div>
    
   
  </div> 
  <div class="container" id="ch6">
    <h3 style="color:white">TEAM Wo Ist?</h3>
    <hr>
    
    <h3>Results</h3>
    <hr>
    <div class="row">
      <div id="img06" class="col-md-5 col-sm-12"><img src="10.png" style="display: block; margin-left: auto;
        margin-right: auto; max-height:85%; max-width: 100%; height:auto; width:auto" id="responsive-image"></div>
     <div class="col-md-7 col-sm-12">
      <div class="card border-secondary">
        <div class="card-header"><h6>Proof of concept:</h6></div>
        <div class="card-body">
          <p class="card-title">We applied our approach on genomes with known CRISPR systems. Here are the characteristics of the genomes:</p>
          <p class="card-text"><ul>
            <li><b>35</b> genomes from <a href="https://crisprcas.i2bc.paris-saclay.fr/MainDb/StrainList" target="_blank">crispr-cas-db</a></li>
            <li>The genome length varied anywhere from <b>1-9 mil. bp.</b></li>
            <li>The quantity of CRISPR arrays varied from <b>1-110</b> per genome.</li>
            <li>Number of spacers in those CRISPR arrays was <b>3050</b>.</li>
            <li>Number of CRISPR systems in total was <b>230</b>.</li>  
          </ul></p>
        </div>
      </div>
      <br>
      <div class="card border-success">
        <div class="card-header"><h6>Results:</h6></div>
        <div class="card-body">
          <div class="card-text">
            <ul>
              <li><b>100%</b> of known systems</li>
              <li><b>~96 %</b> perfect spacer matches</li>
            </ul></div>
        </div>
      </div>
     </div>
    </div>
   
  </div> 
  <div class="container" id="ch7">
    <h3 style="color:white">TEAM Wo Ist?</h3>
    <hr>
    
    <h3>Future Outlook and Take-Home-Message</h3>
    <hr>
    <div class="row">
      
      <div class="col-md-5 col-sm-12">
        <br>
        <div class="card border-warning">
          <div class="card-header"><h6>Future Outlook</h6></div>
          <div class="card-body">
            <p class="card-text"><ul>
              <li>Optimization of de Bruijn graph as a data structure</li>
              <li>Algorithm for removal of false positives</li>
              <li>Detection of imperfect repeats</li>
              <li>Graph reduction</li>
              <li>Parallel computation</li>  
            </ul></p>
          </div>
        </div>
      </div>
       
        <div class="col-md-7 col-sm-12">
          <br>
          <div class="card border-success">
            <div class="card-header"><h6>Take-home Message</h6></div>
            <div class="card-body">
              <div class="card-text">
                <ul>
                  <li>We introduced a new approach, based on a de Bruijn graph, which is the basic data structure used by many (meta-)genome assemblers.</li>
                  <li>We proved that CRISPR arrays are multicycles of length 46-94 nodes in a de Bruijn graph with k-mer size 22.</li>
                  <li>As a proof of concept, we used our approach on known genomic datasets and benchmarked against state-of-the-art methods, where we achieved 96% exact matches in spacer detection.
                  </li>
                  
                </ul></div>
            </div>
      </div>
     </div>
    </div>
   
  </div> 
  <br>
  <br>
  <br>
  <section class="">
    <!-- Footer -->
    <footer class="bg-primary text-white text-center text-md-start">
      <!-- Grid container -->
      <div class="container p-4">
        <!--Grid row-->
        <div class="row">
          <!--Grid column-->
          <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
            <h5 class="text-uppercase">Acknowledgement</h5>
  
            <p>
              This work was funded by the German Ministry of Education and Priority Program: “Much More Than Defense: the Multiple Functions and Facets of CRISPR-Cas (SPP 2141)”
            </p>
          </div>
          <!--Grid column-->
  
          <!--Grid column-->
          <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
  
            <div id="img09" ><img src="11.png" style="display: block; margin-left: auto;
              margin-right: auto; max-height:85%; max-width: 100%; height:auto; width:auto" id="responsive-image"></div>
            </ul>
          </div>
          <!--Grid column-->
  
          <!--Grid column-->
          <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
            <h5 class="text-uppercase mb-0">Links</h5>
  
            <ul class="list-unstyled">
              <li>
                <a target="_blank" href="https://www.ibmg.uni-stuttgart.de/rnabioinf/" class="text-white">Our Group</a>
              </li>
              <li>
                <a target="_blank" href="https://www.dfg.de/" class="text-white">DFG</a>
              </li>
              <li>
                <a target="_blank" href="https://gepris.dfg.de/gepris/projekt/360987069" class="text-white">SPP2141</a>
              </li>
             
            </ul>
          </div>
          <!--Grid column-->
        </div>
        <!--Grid row-->
      </div>
      <!-- Grid container -->
  
      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        © 2022
        <a class="text-white" href="https://www.ibmg.uni-stuttgart.de/rnabioinf/">Computational Biology, IBMG</a>
      </div>
      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </section>
</body>

<script>
  var modal = document.getElementById("myModal");

// Get the image and insert it inside the modal - use its "alt" text as a caption
var img = document.getElementById("myImg");
var modalImg = document.getElementById("img01");
var captionText = document.getElementById("caption");
img.onclick = function(){
  modal.style.display = "block";
  modalImg.src = this.src;
  captionText.innerHTML = this.alt;
}

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}
var modal1 = document.getElementById("myModal1");

// Get the image and insert it inside the modal - use its "alt" text as a caption
var img01 = document.getElementById("myImg1");
var modalImg01 = document.getElementById("img02");
img01.onclick = function(){
  modal1.style.display = "block";
  modalImg1.src = this.src;
}

// Get the <span> element that closes the modal
var span1 = document.getElementsByClassName("close")[1];

// When the user clicks on <span> (x), close the modal
span1.onclick = function() {
  modal1.style.display = "none";
}
$('.navbar-nav>li>a').on('click', function(){
    $('.navbar-collapse').collapse('hide');
});

</script>
    
</body>
